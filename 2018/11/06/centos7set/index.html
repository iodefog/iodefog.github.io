<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="iodefog"><title>CentOS 7 最小安装模式配置服务记录 · iodefog</title><meta name="description" content="CentOS 7 最小安装模式配置服务记录
linux ISO镜像下载地址: http://mirrors.aliyun.com
查看本机的ip地址1234567$ ifconfig-bash: ifconfig: command not found&amp;#x2F;&amp;#x2F; 可查ip命令$  ip "><meta name="keywords"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="short icon" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/blog_basic.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"><meta name="generator" content="Hexo 4.2.1"></head><body><div class="sidebar animated fadeInDown"><div class="logo-title"><div class="title"><img src="/./images/logo.png" style="width:127px;"><h3 title=""><a href="/">iodefog</a></h3><div class="description"><p>记录人生道路景色的，点点滴滴。</p></div></div></div><ul class="social-links"></ul><div class="footer"><a target="_blank" href="/"><span>Theme by </span></a><a href="https://www.caicai.me" target="_blank" rel="noopener"> CaiCai </a><span>&</span><a href="https://github.com/Ben02/hexo-theme-Anatole" target="_blank" rel="noopener"> Ben</a><div class="by_farbox"><a href="https://hexo.io/zh-cn/" target="_blank">Proudly published with Hexo&#65281;</a></div></div></div><div class="main"><div class="page-top animated fadeInDown"><div class="nav"><li><a href="/">首页</a></li><li><a href="/archives">归档</a></li><li><a href="/about">关于</a></li><li><a href="/links">链接</a></li></div><div class="information"><div class="back_btn"><li><a onclick="window.history.go(-1)" class="fa fa-chevron-left"> </a></li></div><div class="avatar"><img></div></div></div><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h3><a>CentOS 7 最小安装模式配置服务记录</a></h3></div><div class="post-content"><p>CentOS 7 最小安装模式配置服务记录</p>
<h1 id="linux-ISO镜像"><a href="#linux-ISO镜像" class="headerlink" title="linux ISO镜像"></a>linux ISO镜像</h1><p>下载地址: <a href="http://mirrors.aliyun.com" target="_blank" rel="noopener">http://mirrors.aliyun.com</a></p>
<h1 id="查看本机的ip地址"><a href="#查看本机的ip地址" class="headerlink" title="查看本机的ip地址"></a>查看本机的ip地址</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ ifconfig</span><br><span class="line"></span><br><span class="line">-bash: ifconfig: command not found</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 可查ip命令</span><br><span class="line">$  ip addr</span><br></pre></td></tr></table></figure>

<h1 id="配置工具"><a href="#配置工具" class="headerlink" title="配置工具"></a>配置工具</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; 更新yum</span><br><span class="line">yum updagate</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 安装Wget</span><br><span class="line">yum install wget</span><br></pre></td></tr></table></figure>

<p>CentOS 7 ifconfig install</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># yum install net-tools</span><br></pre></td></tr></table></figure>

<h1 id="Apache"><a href="#Apache" class="headerlink" title="Apache"></a>Apache</h1><h3 id="Apache-安装"><a href="#Apache-安装" class="headerlink" title="Apache 安装"></a>Apache 安装</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ yum install httpd</span><br></pre></td></tr></table></figure>

<p>安装过程中会提示”is this ok [y/d/N]”，输入y，回车即可。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">systemctl start httpd.service     &#x2F;&#x2F; 启动</span><br><span class="line">systemctl stop httpd.service      &#x2F;&#x2F; 停止</span><br><span class="line">systemctl restart httpd.service   &#x2F;&#x2F; 重启apache</span><br><span class="line"></span><br><span class="line">systemctl status httpd.service    &#x2F;&#x2F; 运行状态</span><br><span class="line">systemctl enable httpd.servic     &#x2F;&#x2F; 重启服务器时自动启动Apache 服务</span><br><span class="line"></span><br><span class="line">vim &#x2F;etc&#x2F;httpd&#x2F;conf&#x2F;httpd.conf    &#x2F;&#x2F; 编辑 配置文件</span><br></pre></td></tr></table></figure>

<h3 id="改变-Apache-默认的站点根目录"><a href="#改变-Apache-默认的站点根目录" class="headerlink" title="改变 Apache 默认的站点根目录"></a>改变 Apache 默认的站点根目录</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir &#x2F;home&#x2F;lhl&#x2F;developer&#x2F;www    &#x2F;&#x2F; 新建文件</span><br></pre></td></tr></table></figure>

<p>修改下 Apache 的配置文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi &#x2F;etc&#x2F;httpd&#x2F;conf&#x2F;httpd.conf</span><br></pre></td></tr></table></figure>

<p>修改</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"># DocumentRoot &quot;&#x2F;var&#x2F;www&#x2F;html&quot;</span><br><span class="line">DocumentRoot &quot;&#x2F;home&#x2F;lhl&#x2F;developer&#x2F;www&quot;</span><br><span class="line"></span><br><span class="line">&lt;Directory &quot;&#x2F;home&#x2F;lhl&#x2F;developer&#x2F;www&quot;&gt;</span><br><span class="line"></span><br><span class="line">    Options Indexes FollowSymLinks</span><br><span class="line">    AllowOverride None</span><br><span class="line">    Order allow,deny</span><br><span class="line">    Allow from all</span><br><span class="line">&lt;&#x2F;Directory&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># &lt;Directory &quot;&#x2F;var&#x2F;www&#x2F;html&quot;&gt;</span><br><span class="line">&lt;Directory &quot;&#x2F;home&#x2F;lhl&#x2F;developer&#x2F;www&quot;&gt;</span><br><span class="line">    Options Indexes FollowSymLinks</span><br><span class="line">    AllowOverride All</span><br><span class="line">    Require all granted</span><br><span class="line">&lt;&#x2F;Directory&gt;</span><br></pre></td></tr></table></figure>

<h3 id="查询日志"><a href="#查询日志" class="headerlink" title="查询日志"></a>查询日志</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;var&#x2F;log&#x2F;httpd&#x2F;error_log</span><br></pre></td></tr></table></figure>

<h3 id="解决403文件"><a href="#解决403文件" class="headerlink" title="解决403文件"></a>解决403文件</h3><p>把自定义路径下的文件夹全部改成 777权限, 750权限不够</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod -R 777 &#x2F;home&#x2F;lhl&#x2F;developer&#x2F;www</span><br></pre></td></tr></table></figure>

<p>如果在selinux成为问题的情况下，而不是仅仅禁用它，这个页面和这个页面给了命令授予访问权限：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chcon -R -t httpd_sys_content_t &#x2F;home&#x2F;lhl&#x2F;developer&#x2F;www</span><br></pre></td></tr></table></figure>

<h3 id="安装MariaDB"><a href="#安装MariaDB" class="headerlink" title="安装MariaDB"></a>安装MariaDB</h3><p>CentOS 7.0中，已经使用MariaDB替代了MySQL数据库</p>
<p>1、安装MariaDB</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">yum install mariadb mariadb-server #询问是否要安装，输入Y即可自动安装,直到安装完成</span><br><span class="line"></span><br><span class="line">systemctl start mariadb.service #启动MariaDB</span><br><span class="line"></span><br><span class="line">systemctl stop mariadb.service #停止MariaDB</span><br><span class="line"></span><br><span class="line">systemctl restart mariadb.service #重启MariaDB</span><br><span class="line"></span><br><span class="line">systemctl enable mariadb.service #设置开机启动</span><br><span class="line"></span><br><span class="line">cp &#x2F;usr&#x2F;share&#x2F;mysql&#x2F;my-huge.cnf &#x2F;etc&#x2F;my.cnf #拷贝配置文件（注意：如果&#x2F;etc目录下面默认有一个my.cnf，直接覆盖即可）</span><br></pre></td></tr></table></figure>

<p>2、为root账户设置密码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql_secure_installation</span><br></pre></td></tr></table></figure>
<p>回车，根据提示输入Y</p>
<p>输入2次密码，回车</p>
<p>根据提示一路输入Y</p>
<p>最后出现：Thanks for using MySQL!</p>
<p>MariaDB密码设置完成，重新启动 MariaDB：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart mariadb.service #重启MariaDB</span><br></pre></td></tr></table></figure>

<h3 id="安装PHP"><a href="#安装PHP" class="headerlink" title="安装PHP"></a>安装PHP</h3><p>1、安装PHP</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install php #根据提示输入Y直到安装完成</span><br></pre></td></tr></table></figure>
<p>2、安装PHP组件，使PHP支持 MariaDB</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install php-mysql php-gd libjpeg* php-ldap php-odbc php-pear php-xml php-xmlrpc php-mbstring php-bcmath php-mhash</span><br></pre></td></tr></table></figure>
<p>#这里选择以上安装包进行安装，根据提示输入Y回车</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart mariadb.service #重启MariaDB</span><br><span class="line"></span><br><span class="line">systemctl restart httpd.service #重启apache</span><br></pre></td></tr></table></figure>

<h3 id="php配置"><a href="#php配置" class="headerlink" title="php配置"></a>php配置</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">vi &#x2F;etc&#x2F;php.ini #编辑</span><br><span class="line"></span><br><span class="line">date.timezone &#x3D; PRC #把前面的分号去掉，改为date.timezone &#x3D; PRC</span><br><span class="line"></span><br><span class="line">disable_functions &#x3D; passthru,exec,system,chroot,scandir,chgrp,chown,shell_exec,proc_open,proc_get_status,ini_alter,ini_alter,ini_restore,dl,openlog,syslog,readlink,symlink,popepassthru,stream_socket_server,escapeshellcmd,dll,popen,disk_free_space,checkdnsrr,checkdnsrr,getservbyname,getservbyport,disk_total_space,posix_ctermid,posix_get_last_error,posix_getcwd, posix_getegid,posix_geteuid,posix_getgid, posix_getgrgid,posix_getgrnam,posix_getgroups,posix_getlogin,posix_getpgid,posix_getpgrp,posix_getpid, posix_getppid,posix_getpwnam,posix_getpwuid, posix_getrlimit, posix_getsid,posix_getuid,posix_isatty, posix_kill,posix_mkfifo,posix_setegid,posix_seteuid,posix_setgid, posix_setpgid,posix_setsid,posix_setuid,posix_strerror,posix_times,posix_ttyname,posix_uname</span><br><span class="line"></span><br><span class="line">#列出PHP可以禁用的函数，如果某些程序需要用到这个函数，可以删除，取消禁用。</span><br><span class="line"></span><br><span class="line">expose_php &#x3D; Off #禁止显示php版本的信息</span><br><span class="line"></span><br><span class="line">short_open_tag &#x3D; ON #支持php短标签</span><br><span class="line"></span><br><span class="line">open_basedir &#x3D; .:&#x2F;tmp&#x2F;  #设置表示允许访问当前目录(即PHP脚本文件所在之目录)和&#x2F;tmp&#x2F;目录,可以防止php木马跨站,如果改了之后安装程序有问题(例如：织梦内容管理系统)，可以注销此行，或者直接写上程序的目录&#x2F;data&#x2F;www.osyunwei.com&#x2F;:&#x2F;tmp&#x2F;</span><br></pre></td></tr></table></figure>
<p>:wq! #保存退出</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart mariadb.service #重启MariaDB</span><br><span class="line"></span><br><span class="line">systemctl restart httpd.service #重启apache</span><br></pre></td></tr></table></figure>

<p>其他：<br>CentOS7搭建配置Nginx+PHP+MySQL<br><a href="https://www.jianshu.com/p/495a02eb2672" target="_blank" rel="noopener">https://www.jianshu.com/p/495a02eb2672</a></p>
<p>参考：<br><a href="https://www.jianshu.com/p/12aa3791e4d5" target="_blank" rel="noopener">https://www.jianshu.com/p/12aa3791e4d5</a><br><a href="https://askubuntu.com/questions/451922/apache-access-denied-because-search-permissions-are-missing" target="_blank" rel="noopener">https://askubuntu.com/questions/451922/apache-access-denied-because-search-permissions-are-missing</a><br><a href="http://yunkus.com/centos7-apache-service-install-config/" target="_blank" rel="noopener">http://yunkus.com/centos7-apache-service-install-config/</a></p>
<p><a href="https://www.centos.org/forums/viewtopic.php?t=51249" target="_blank" rel="noopener">https://www.centos.org/forums/viewtopic.php?t=51249</a></p>
</div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2018-11-06</span><i class="fa fa-tag"></i><a href="/categories/技术-Apache-centos/" title="技术, Apache , centos" class="tag">技术, Apache , centos </a></div></div></div></div><div class="pagination"><ul class="clearfix"></ul></div></div></div></div></div><script src="/js/jquery.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script></body></html>